---
#========================================================================
# Development Docker Compose - Build images locally
# 
# This file extends docker-compose.yml and adds build configurations
# for local development. Use this when you want to build images locally
# instead of pulling from GHCR.
#
# Usage:
#   docker compose -f docker-compose.yml -f docker-compose.dev.yml up -d
#   docker compose -f docker-compose.yml -f docker-compose.dev.yml build
#========================================================================

services:
  # Base image (required for web and jail builds)
  boca-base:
    image: ghcr.io/odiador/boca-base:latest
    build: 
      context: .
      dockerfile: docker/dev/base/Dockerfile

  # Web app - override with build config
  boca-web:
    image: ghcr.io/odiador/boca-web:latest
    build:
      context: .
      dockerfile: docker/dev/web/Dockerfile
      args:
        BASE_IMAGE: ghcr.io/odiador/boca-base:latest

  # Online judge - override with build config
  boca-jail:
    image: ghcr.io/odiador/boca-jail:latest
    build:
      context: .
      dockerfile: docker/dev/jail/Dockerfile
      args:
        BASE_IMAGE: ghcr.io/odiador/boca-base:latest

  # Database admin interface (optional for development)
  boca-adminer:
    image: adminer:latest
    depends_on:
      - boca-db
    environment:
      - ADMINER_DEFAULT_SERVER=boca-db
    ports:
      - "8080:8080"
